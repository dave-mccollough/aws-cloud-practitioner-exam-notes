# Amazon S3

## Overview

- AWS object storage solution - simple storage solution
- S3 Use Cases
  - Backup and Storage
  - Disaster Recovery
  - Archive
  - Hybrid Cloud Storage
  - Application Hosting
  - Media Hosting
  - Data Lake/Data Analytics
  - Software Delivery
  - Static Websites

- S3 Buckets
  - Store objects (files) in buckets (folders and directories)
  - Buckets must have global unique name
  - Defined at region level
    - S3 is a global service, but buckets are created in a region
  - Naming convention
    - No uppercase
    - No underscores
    - 3-36 characters long
    - Not formated like an IP
    - Must start with a lowercase letter or number
    - Must not start with the prefix`xn--`
    - Must not start with the prefix `sthree-`
    - Must not start with the prefix `amzn-s3-demo-`
    - Must not end with the suffix `-s3alias`

- S3 Objects
  - Objects(files) have a key
  - The key is the full file path
    - `s3://my-bucket/my-file.txt
  - Max object size is 5TB
    - If object size is larger than 5GB, must use multi-part upload
  - Metadata
    - List of text key/key value pairs 
  - Tags
    - Unicode key
  - Version ID 
    - If versioning is enabled

## S3 Security

- User Based
  - IAM Policies
  - Which API calls should be allowed from a specific user
- Resource Based
  - Bucket Policies
    - Bucket wide rules set in the S3 console
    - Used for buckets and objects
    - Allow or Deny access
      - Grant public access to buckets
      - Force objects to be encrypted at upload
      - Grant access to another account (Cross account)
  - Object Access Control List (ACL)
    - Finer grained access control
    - Can be disabled
  - Bucket Access Control List
    - Less common
    - Can be disabled
- IAM Principal can can access S3 bucket if
  - IAM permission or resource permission allows and there's no explicit deny
- Encrypt objects with encryption keys

## Static Web Hosting

- S3 can host static websites
- Website URL will depend on region
  - `http://bucket-name.s3-website-aws-region.amazonaws.com
- If you get 403 error, make sure the bucket allows public reads

## S3 Versioning

- Files can be versioned in S3
- Versioning can be enabled at the bucket level
- Protects against unintended deletes
- Roll back to previous version

## S3 Replication

- Cross-Region Replication (CRR)
  - Compliance, lower latency, replication across accounts
- Same-Region Replication (SRR)
  - Log aggration, live replication between prod and test accounts
- Versioning must be enabled in source and destination buckets

## S3 Storage Classes

- S3 Standard - General Purpose
  - 99.99% Availability
  - Used for frequently accessed data
  - Low latency and high throughpu
  - Can sustain 2 concurrent facility failures
  - Use Cases
    - Data analytics, content distribution, application data
- S3 Standard - Infrequent Access (S3 Standard IA)
  - 99.9% Availability
  - For data less frequently accessed, but rapid access when needed
  - Lower cost than S3 standard
  - Use Cases
    - Disaster Recovery
- S3 One Zone Infrequent Access (S3 One Zone-IA)
  - 99.5% Availability
  - High Durability
  - User Cases
    - Secondary backups of on-prem data
    - Data you can recreate
- S3 Glacial Instant Retrieval
  - Archive and backup
  - Millisecond Retrieval
  - Miniumn storage duration - 90 days
- S3 Glacial Flexible Retrieval
  - Archive and backup
  - Retrieval times
    - Expedited
      - 1-5 minutes
    - Standard
      - 3-5 hours
    - Bulk
      - 5-12 hours
  - Miniumn storage duration - 90 days
- S3 Glacial Deep Archive
  - Archive and backup
  - Retrieval times
    - Standard
      - 12 hours
    - Bulk
      - 48 hours
  - Miniumn storage duration - 180 days
- S3 Intelligent Tiering
  - Small monitoring and auto-tiering fee
  - Move objects between tiers based on usage
  - No retrieval charges

- Durability
  - 99.999999999% (11 9's) of durability across multiple AZ
  - Same for all storage classes
- Availability
  - Varies depending on storage class

## S3 Express One Zone

- High performance single availability zone storage class
- Objects stored in a directory bucket (bucket in a single AZ)
- Co-location storage and compute resources in the same AZ
  - Reduce latency
- Use cases
  - Data intesive apps
  - AI/ML training
  - Financial Modeling
- Best integrated with 
  - Sagemaker model training
  - Athena
  - EMR
  - Glue

## Encryption

- Server Side Encryption
  - Default
  - Always on
- Client Side Encryption

## IAM Access Analyzer

- Ensures only intended people have access to S3 Buckets
- Evaluates S3 Bucket policies, ACL, Access Point Policies
- Powered by IAM Access Analyzer

## Shared Responsibility for S3

- AWS
  - Infrastructure
  - Configuration and vulnerability analysis
  - Compliance validation
- User
  - Versioning
  - Bucket Policies
  - Replication setup
  - Logging and monitoring
  - Storage classes
  - Data encryption at rest and in transit

## AWS Snowball/Snowfamily

- Secure, portable devices that collect and process data at the edge and migrate data in and out of AWS
- Helps migrate petabytes of data
- Snowball Edge Devices
  - No longer available to new customers
- Pay for device usage and data transfer out of AWS
- On Demand and Upfront commitments

## Storage Gatesay

- Hybrid solution to extend on-prem storage to S3